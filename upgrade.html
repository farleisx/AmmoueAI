<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ammoue AI | Upgrade to Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .text-ammoue { color: #0d9488; }
        .bg-ammoue { background-color: #0d9488; }
    </style>
</head>
<body class="antialiased min-h-screen flex items-center justify-center">

    <div class="max-w-md mx-auto p-8 bg-white border border-gray-200 rounded-2xl shadow-xl text-center">
        <h1 class="text-3xl font-bold text-gray-900 mb-6">Upgrade to <span class="text-ammoue">Pro</span></h1>

        <!-- Instructions -->
        <div id="instructions" class="mb-6 text-left">
            <h3 class="text-xl font-semibold mb-2">How to Pay</h3>
            <ol class="list-decimal list-inside text-gray-700 space-y-1">
                <li>Open your <strong>Phantom Wallet</strong> or another Solana wallet.</li>
                <li>Scan the QR code below, or copy the payment link.</li>
                <li>Send exactly <strong>$5</strong> worth of SOL.</li>
                <li>Include this reference code in your payment:</li>
                <pre id="reference-code" class="bg-gray-100 p-2 rounded text-sm">TEST1234567890</pre>
                <li>Once the payment is received, this page will automatically confirm your upgrade.</li>
            </ol>
        </div>

        <!-- QR code / Payment link -->
        <div id="crypto-qr" class="bg-gray-100 p-6 rounded-lg mb-4 text-center text-sm">
            [QR Code Placeholder]
        </div>

        <!-- Status message -->
        <p id="status-message" class="mt-4 text-gray-600 font-medium">Waiting for payment...</p>

        <!-- Retry button -->
        <button id="retry-btn" class="mt-6 px-6 py-3 rounded-xl bg-ammoue text-white hover:bg-teal-700 transition">
            Retry Payment
        </button>
    </div>

    <script type="module">
        // Mock data for testing
        const mockPaymentLink = "https://solana.com/fake-payment-link";
        const mockReferenceCode = "TEST1234567890";

        const qrElement = document.getElementById("crypto-qr");
        const statusMessage = document.getElementById("status-message");
        const referenceElement = document.getElementById("reference-code");
        const retryBtn = document.getElementById("retry-btn");

        // Display mock QR and reference
        qrElement.textContent = `Scan this QR or visit: ${mockPaymentLink}`;
        referenceElement.textContent = mockReferenceCode;

        // Mock payment confirmation flow
        let paymentConfirmed = false;

        async function startCryptoPayment() {
            try {
                statusMessage.textContent = "Waiting for payment confirmation...";

                // Mock polling interval
                let attempts = 0;
                const interval = setInterval(() => {
                    attempts++;
                    // Simulate payment confirmation after 5 seconds
                    if (attempts === 5) {
                        paymentConfirmed = true;
                        clearInterval(interval);
                        statusMessage.textContent = "Payment received! Redirecting...";
                        setTimeout(() => {
                            window.location.href = "success.html";
                        }, 1500);
                    }
                }, 1000);

            } catch (err) {
                console.error("Payment initiation error:", err);
                statusMessage.textContent = "Failed to initiate payment. Please retry.";
            }
        }

        // Retry button
        retryBtn.addEventListener("click", () => {
            if (!paymentConfirmed) startCryptoPayment();
        });

        // Start payment flow immediately
        startCryptoPayment();
    </script>
</body>
</html>
